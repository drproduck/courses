3. 
a. A register steps when its bit equals the majority over 3 bits. There are 8 possible permutations of 3 bits. The permutations where the first bit is the majority are: 101, 110, 010, 001, 111, 000 => 6 permutations => 6/8 = 3/4
b. x and y are interchangeable => 3/4
c. 3/4
d. possible permutations: 111, 000 => 2/8 = 1/4
e. w.l.o.g suppose exactly x and y step. Possible permutations: 110, 001 => 1/4
f. 0 because the majority function dictates at least 2 always step
g. 0 (same as f)

7. code in a seperated file

9. 
a. Feistel cipher: a general cipher design principle.
Encryption:
the plaintext is split into left and right halves:
P = (L0, R0)
for i from 1 to n, the halves are updated:
Li = Ri-1
Ri = Li-1 ^ F(Ri-1, Ki)
where Ki is the subkey for round i, and F is the round function. The ciphertext is (Ln, Rn)
Decryption:
Ri-1 = Li
Li-1 = Ri ^ F(Ri-1, Ki)

b. DES is a Feistel cipher
c. AES is not a Feistel cipher because its operations have to be invertible
d. TEA is not a Feistel cipher because again its operation have to be invertible but it does that by using bt shift, addition and subtraction, which simplicity is as close as of XOR

11. 
b. Diffusion: In a block, the new left half is the old right half, and the new right half is the old left half xor a round function 
a. Confusion: The S-boxes expand and squeeze the bits in a half before feeding in a round function, effectively altering it.

12.
a. 64 bits in a plaintext block
b. 64 bits in a ciphertext block
c. key is 56 bits
d. subkey is 48 bits
e. 16 round
f. 8 S-boxes
g. S-box requires 48 bits of input
h. S-box generates 32 bits of input

20.
a. C0 ^ IV = E(P0, K)
Thus decryption rule is:
P0 = D(C0 ^ IV, K)
P1 = D(C1 ^ C0, K)
P2 = D(C2 ^ C1, K) ...
b. Weakness of this encryption: Because Cn-1Cn = E(Pn, K), which is a straight mapping from the plaintext, the same plaintext will give the same xor of 2 consecutive ciphertexts. More specfically, given ciphertext C1C2...Cn, tranform it to (VI^C1)(C1^C2)...(Cn-1^Cn) (everything is known up to VI), and a pair of new ciphertext blocks are the same if and only if the pair of plaintexts at those location are the same. This weakness can give rise to similar attack against ECB mode e.g new cipher-text only attack 
2nd possible disadvantage compared to CBC is this cipher is useless for MAC. The plaintext only depends on ciphertext and key ( = D(Cn^Cn-1,K)) so that there is no chaining of plaintext that will propagate error to the final MAC block. 

21. 
Since calculation of Pi requires Ci and Ci-1 we need random access to both Ci and Ci-1, or in the case of P0, C0 and VI are needed.
The disadvantage comes from having to use 2 ciphertexts in a random access environment. If we lose track of ciphertext e.g 2 consecutive ciphertexts were not written sequentially on a disk then their is no way to get the correct pair of ciphertexts for decryption
 
24. 

25.
a. If they keep using the same IV then the start of a message can be determined. Also P0^IV = D(C0, K) and thus the same C0's will give the same P0's if this IV is repeated multiple times.
b. Because the only agen of confusion isCBC is more dangerous because you can attack the repetition in 

29. P1 = D(C1, K)^C0
=>  D(C1, K) = P1^C0 is known
    Suppose we want to find C (unknown) such that the resulting decryption will return plaintext X (known). Then:
    D(C1, K)^C = X
=>  P1^C0^C    = X
=>  P1^C0^X    = C, and the left hand side is known

30
As Bob decrypts using C0, X, C2, C3: P0 = D(C0, K2)^IV, !P1 = D(X, K2)^C0, !P2 = D(C2, K2)^X, P3 = D(C3, K2)^C2
Bob checks MAC (The Ci here are not ciphertexts but immediate texts computed leading to MAC, meaning Bob doesnt know them except for the last Cn-1 i.e MAC): 
C0 = E(P0^IV, K1), !C1 = E(!P1^C0, K1), !C2 = E(!P2^!C1, K1), !C3 = E(P3^!C2, K1) != MAC 
What could go wrong here is !P2^!C1 = P2^C1
21, 24, 25, 29, 30. 
    
